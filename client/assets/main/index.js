window.__require=function e(t,n,i){function o(r,s){if(!n[r]){if(!t[r]){var c=r.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+r+"'")}r=c}var u=n[r]={exports:{}};t[r][0].call(u.exports,function(e){return o(t[r][1][e]||e)},u,u.exports,e,t,n,i)}return n[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<i.length;r++)o(i[r]);return o}({AvailablePositionsHelper:[function(e,t){"use strict";cc._RF.push(t,"b6b74fa44VDXYuxG9zQdBFh","AvailablePositionsHelper"),cc.Class({properties:{positionCenterInWorld:cc.v2(),arrIndex:[]}}),cc._RF.pop()},{}],CellGameField:[function(e,t){"use strict";cc._RF.push(t,"a8aef+qqHxLL4c5ozVM9sTd","CellGameField"),cc.Class({extends:cc.Component,properties:{shadowBlock:{default:null,type:cc.Node},attachedNode:{default:null,type:cc.Node,visible:!1}},toggleShadowBlock:function(e){this.shadowBlock.active=e}}),cc._RF.pop()},{}],CellGridPlayer:[function(e,t){"use strict";cc._RF.push(t,"57baaUrdCxIbJnoFI4UevX3","CellGridPlayer"),cc.Class({extends:cc.Component,properties:{renderNode:{default:null,type:cc.Node},attachedNode:{default:null,type:cc.Node}}}),cc._RF.pop()},{}],CellPuzzle:[function(e,t){"use strict";cc._RF.push(t,"c3010A2q7FMtLm19FUZb9Ol","CellPuzzle"),cc.Class({extends:cc.Component,properties:{shadowBlock:{default:null,type:cc.Node},mainBlock:{default:null,type:cc.Node},shineBlock:{default:null,type:cc.Node},disableBlock:{default:null,type:cc.Node},isBusy:{default:!1,notify:function(){this.mainBlock.active=isBusy}}}}),cc._RF.pop()},{}],Cell:[function(e,t){"use strict";cc._RF.push(t,"dd9eeVMruhC8bu6P/iUNPmT","Cell"),cc.Class({extends:cc.Component,properties:{renderNode:{default:null,type:cc.Node},isBusy:{default:!1,notify:function(){this.renderNode.opacity=255*this.isBusy}}}}),cc._RF.pop()},{}],DataDictionary:[function(e,t){"use strict";cc._RF.push(t,"8bacaIc0xxD7L2RC2wQamct","DataDictionary");var n=o(e("DataType")),i=o(e("GameEvent"));function o(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{PREVIEW:{default:!1,editorOnly:!0},dataType:{default:n.default.None,type:n.default,notify:function(){-1===this._convertDataType.indexOf(this.dataType)&&(this._convertDataType.push(this.dataType),this._data.push(null)),this.data=this._data[this._convertDataType.indexOf(this.dataType)]}},data:{default:null,type:cc.JsonAsset,notify:function(){this.dataType===n.default.None||null!==this.data&&!this.data||(this._data[this._convertDataType.indexOf(this.dataType)]=this.data)},visible:function(){return this.dataType!==n.default.None}},convertDataType:{get:function(){return this._convertDataType},type:[n.default],visible:function(){return this.PREVIEW}},_convertDataType:{default:function(){return[n.default.None]},type:[n.default]},_data:{default:function(){return[null]},type:[cc.JsonAsset]}},onLoad:function(){this._subscribeEvents(!0)},_subscribeEvents:function(e){var t=e?"on":"off";cc.systemEvent[t](i.default.GET_DATA,this.onGetData,this)},_getData:function(e){var t=this._convertDataType.indexOf(e);return-1!==t?this._data[t]:null},onGetData:function(e,t){var n=this._getData(e);t instanceof Function&&t(n)}}),cc._RF.pop()},{DataType:"DataType",GameEvent:"GameEvent"}],DataType:[function(e,t,n){"use strict";cc._RF.push(t,"1a8f4Kc8wxOE7veGVvJCjLp","DataType"),n.__esModule=!0,n.default=void 0;var i=cc.Enum({None:0,PuzzleGridData:1,GameFieldCombinations:2});n.default=i,t.exports=n.default,cc._RF.pop()},{}],Enemy:[function(e,t){"use strict";cc._RF.push(t,"af316vRenZEqYUpTHaxeur0","Enemy"),cc.Class({extends:cc.Component,properties:{},onEnable:function(){this._handleSubscription(!0)},onDisable:function(){this._handleSubscription(!1)},_handleSubscription:function(){}}),cc._RF.pop()},{}],GameEvent:[function(e,t,n){"use strict";cc._RF.push(t,"8be8d8L+t9PdI9Pis312ZTx","GameEvent"),n.__esModule=!0,n.default=void 0;var i=cc.Enum({NONE:0,INPUT:1,GET_DATA:2,PUZZLE_CAPTURED:3,PUZZLE_RELEASED:4,PUZZLE_MOVE:5,CREATE_TARGET_PUZZLE:6,PUZZLE_PINNED:7,UPDATE_PLAYER_SCORE:100,UPDATE_ENEMY_SCORE:101,SET_PLAYER_NAME:200,SET_ENEMY_NAME:201,UPDATE_TIMER:301});n.default=i,t.exports=n.default,cc._RF.pop()},{}],GameField:[function(e,t){"use strict";cc._RF.push(t,"7a3deOKTo9MC6cso2surHO+","GameField");var n=r(e("GameEvent")),i=r(e("AvailablePositionsHelper")),o=r(e("TargetPuzzleHelper")),a=r(e("CellGameField"));function r(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{cellPrefab:{default:null,type:cc.Prefab},gridMatrixSize:new cc.Size,dividerSize:0,_grid:{default:[],serializable:!1},_arrayTargetPuzzles:{default:[],serializable:!1},_currentTargetPuzzle:null,_oldTargetPuzzles:null},onEnable:function(){this._createGrid(),this._handleSubscription(!0)},onDisable:function(){this._handleSubscription(!0)},_handleSubscription:function(e){var t=e?"on":"off";cc.systemEvent[t](n.default.CREATE_TARGET_PUZZLE,this.onCreateTargetPuzzle,this),cc.systemEvent[t](n.default.PUZZLE_CAPTURED,this.onPuzzleCaptured,this),cc.systemEvent[t](n.default.PUZZLE_RELEASED,this.onPuzzleReleased,this),cc.systemEvent[t](n.default.PUZZLE_MOVE,this.onPuzzleMove,this)},_createGrid:function(){for(var e=0;e<this.gridMatrixSize.width;e++){this._grid.push([]);for(var t=0;t<this.gridMatrixSize.height;t++){var n=cc.instantiate(this.cellPrefab),i=n.getComponent(a.default),o=cc.v2(-this.node.width/2+t*n.width+n.width/2+t*this.dividerSize,this.node.height/2-e*n.height-n.height/2-e*this.dividerSize);n.setPosition(o),n.parent=this.node,this._grid[e].push(i)}}},_getAvailablePositions:function(e){for(var t=null,n=null,o=[],a=0;a<this._grid.length-e.puzzle._grid.length+1;a++)for(var r=0;r<this._grid[a].length-e.puzzle._grid[0].length+1;r++){var s=[];t=this._grid[a][r];for(var c=!0,l=0;l<e.puzzle._grid.length;l++){for(var u=0;u<e.puzzle._grid[l].length;u++)if(n=this._grid[a+l][r+u],e.puzzle._grid[l][u].isBusy){if(this._grid[a+l][r+u].attachedNode){c=!1;break}s.push({i:a+l,j:r+u,block:e.puzzle._grid[l][u].node})}if(!c)break}if(c){var d=new i.default;d.arrIndex=s;var h=this._getCenterInGrid(t,n);d.positionCenterInWorld=this.node.convertToWorldSpaceAR(h),o.push(d)}}return o},_getCenterInGrid:function(e,t){return e.node===t.node?e.node.position:cc.v2((e.node.position.x+t.node.position.x)/2,(e.node.position.y+t.node.position.y)/2)},_createTargetPuzzle:function(e){var t=new o.default;return t.puzzle=e,t},_checkCombinations:function(){for(var e=this,t=0,i=[],o=0;o<this._grid.length;o++)this._grid[o].every(function(e){return e.attachedNode})&&(i.push(this._grid[o]),t++);for(var a=0;a<this._grid.length;a++){for(var r=!0,s=[],c=0;c<this._grid[a].length;c++){if(!this._grid[c][a].attachedNode){r=!1;break}s.push(this._grid[c][a])}r&&(i.push(s),t++)}for(var l=0;l<9;l++){for(var u=!0,d=[],h=3*Math.trunc(l/3);h<3*(Math.trunc(l/3)+1);h++){for(var p=l%3*3;p<3*(l%3+1);p++){if(!this._grid[h][p].attachedNode){u=!1;break}d.push(this._grid[h][p])}if(!u)break}u&&(i.push(d),t++)}var f=i.flat(),_=f.filter(function(e,t){return f.indexOf(e)===t});cc.log("\u043a\u043e\u043b-\u0432\u043e \u043a\u043e\u043c\u0431\u0438\u043d\u0430\u0446\u0438\u0439: "+t,"\u043a\u043e\u043b-\u0432\u043e \u043e\u0447\u043a\u043e\u0432: "+_.length*t),cc.systemEvent.emit(n.default.UPDATE_PLAYER_SCORE,_.length*t);var v=_.map(function(e){return e.attachedNode});_.forEach(function(e){e.attachedNode=null}),v.forEach(function(e){cc.tween(e).to(.1,{scale:0}).call(function(){e.active=!1}).start()}),this._arrayTargetPuzzles.forEach(function(t){var n=[].concat(e._getAvailablePositions(t));t.availablePositions=n})},onCreateTargetPuzzle:function(e){var t=this._createTargetPuzzle(e);t.availablePositions=[].concat(this._getAvailablePositions(t)),this._arrayTargetPuzzles.push(t)},onPuzzleCaptured:function(e){this._currentTargetPuzzle=this._arrayTargetPuzzles.find(function(t){return t.puzzle.node===e.node})},onPuzzleMove:function(e){var t=this,n=e.node.parent.convertToWorldSpaceAR(e.node.position),i=this._currentTargetPuzzle.availablePositions.map(function(e){return e.positionCenterInWorld.sub(n).len()}),o=Math.min.apply(Math,i),a=i.indexOf(o);o<150?(this._currentTargetPuzzle.currentAvailablePositionIndex=a,this._currentTargetPuzzle.oldAvailablePositionIndex>-1&&this._currentTargetPuzzle.availablePositions[this._currentTargetPuzzle.oldAvailablePositionIndex].arrIndex.forEach(function(e){t._grid[e.i][e.j].toggleShadowBlock(!1)}),this._currentTargetPuzzle.availablePositions[a].arrIndex.forEach(function(e){t._grid[e.i][e.j].toggleShadowBlock(!0)}),e.targetPosition=this._currentTargetPuzzle.availablePositions[a].positionCenterInWorld,this._currentTargetPuzzle.oldAvailablePositionIndex=a):(this._currentTargetPuzzle.oldAvailablePositionIndex>-1&&this._currentTargetPuzzle.availablePositions[this._currentTargetPuzzle.oldAvailablePositionIndex].arrIndex.forEach(function(e){t._grid[e.i][e.j].toggleShadowBlock(!1)}),this._currentTargetPuzzle.currentAvailablePositionIndex=null,e.targetPosition=null)},onPuzzleReleased:function(e){var t=this;if(e.targetPosition){this._currentTargetPuzzle.availablePositions[this._currentTargetPuzzle.currentAvailablePositionIndex].arrIndex.forEach(function(e){t._grid[e.i][e.j].attachedNode=e.block,t._grid[e.i][e.j].toggleShadowBlock(!1)}),e.isPinned=!0;var i=this._arrayTargetPuzzles.findIndex(function(t){return t.puzzle.node===e.node});this._arrayTargetPuzzles.splice(i,1),cc.systemEvent.emit(n.default.PUZZLE_PINNED,e),this._checkCombinations()}this._currentTargetPuzzle.oldAvailablePositionIndex=-1,this._currentTargetPuzzle=null}}),cc._RF.pop()},{AvailablePositionsHelper:"AvailablePositionsHelper",CellGameField:"CellGameField",GameEvent:"GameEvent",TargetPuzzleHelper:"TargetPuzzleHelper"}],GameManager:[function(e,t){"use strict";cc._RF.push(t,"a4f1bk2Tw1MxJotUTosVzoU","GameManager"),cc.Class({extends:cc.Component,properties:{},onEnable:function(){cc.macro.ENABLE_MULTI_TOUCH=!1}}),cc._RF.pop()},{}],GameObjectManager:[function(e,t){"use strict";cc._RF.push(t,"2bc9a3Ou3hMKIipLx7riKte","GameObjectManager"),cc.Class({extends:cc.Component,properties:{},start:function(){}}),cc._RF.pop()},{}],GameObjectType:[function(e,t){"use strict";cc._RF.push(t,"49962XGOaFOiab2VwQZiQtf","GameObjectType"),cc.Class({extends:cc.Component,properties:{},start:function(){}}),cc._RF.pop()},{}],GameObject:[function(e,t){"use strict";cc._RF.push(t,"e7838R72TFM/5/98eq4cRXh","GameObject"),cc.Class({extends:cc.Component,properties:{},start:function(){}}),cc._RF.pop()},{}],GridPlayer:[function(e,t){"use strict";var n;cc._RF.push(t,"76c2dr9WBFJ0oT4kgnKEkgE","GridPlayer"),(n=e("GameEvent"))&&n.__esModule;var i=cc.Class({name:"CellPlayerGrid",properties:{node:null,localPosition:[],worldPosition:[],arrIndex:[]}});cc.Class({extends:cc.Component,properties:{cellPrefab:{default:null,type:cc.Prefab},_gridSize:cc.v2(9,9),_cellSize:new cc.Size(100,100),_dividerSize:5,_grid:[],arrayPossiblePosition:[]},onEnable:function(){this._createGrid(),this._handleSubscription(!0)},update:function(){this.arrayPossiblePosition.length},onDisable:function(){this._handleSubscription(!1)},_handleSubscription:function(){},_createGrid:function(){this._grid=[];for(var e=0;e<this._gridSize.x;e++){this._grid.push([]);for(var t=0;t<this._gridSize.y;t++){var n=cc.instantiate(this.cellPrefab),i=n.getComponent("CellGridPlayer"),o=cc.v2(-this.node.width/2+t*n.width+n.width/2+t*this._dividerSize,this.node.height/2-e*n.height-n.height/2-e*this._dividerSize);n.setPosition(o),n.parent=this.node,this._grid[e].push(i)}}},_getCenterInGrid:function(e,t){if(e.x===t.x&&e.y===t.y)return this._grid[e.x][e.y].node.position;var n=this._grid[e.x][e.y].node.position,i=this._grid[t.x][t.y].node.position;return cc.v2((n.x+i.x)/2,(n.y+i.y)/2)},onPuzzleCaptured:function(e){var t,n;this.arrayPossiblePosition=[];for(var o=0;o<this._grid.length-e._grid.length+1;o++)for(var a=0;a<this._grid[o].length-e._grid[0].length+1;a++){var r=[],s=!0;if(t=cc.v2(o,a),!this._grid[o][a].attachedNode){for(var c=0;c<e._grid.length;c++){for(var l=0;l<e._grid[c].length;l++)if(n=cc.v2(o+c,a+l),e._grid[c][l].isBusy){if(this._grid[o+c][a+l].attachedNode){cc.log("\u043c\u0435\u0441\u0442 \u043d\u0435\u0442"),s=!1;break}r.push(cc.v2(o+c,a+l))}if(!s)break}if(s){var u=new i;u.node=e.node,u.arrIndex=r,u.localPosition=this._getCenterInGrid(t,n),u.worldPosition=this.node.convertToWorldSpaceAR(u.localPosition),this.arrayPossiblePosition.push(u)}}}},onPuzzleMove:function(e){var t=this,n=e.node.parent.convertToWorldSpaceAR(e.node.position),i=this.arrayPossiblePosition.map(function(e){return e.worldPosition.sub(n).len()}),o=Math.min.apply(Math,i),a=i.indexOf(o);this.arrayPossiblePosition[a].arrIndex.forEach(function(e){t._grid[e.x][e.y].renderNode.opacity=120}),e.targetPosition=this.arrayPossiblePosition[a].worldPosition},onPuzzleReleased:function(){}}),cc._RF.pop()},{GameEvent:"GameEvent"}],IInputCommand:[function(e,t,n){"use strict";cc._RF.push(t,"a776431k/NCb70A4/vHibe9","IInputCommand"),n.__esModule=!0,n.default=void 0;var i=function(){function e(e){this.node=e.node,this.manager=e,this.touches=e.touches,this._currentTouch=null}var t=e.prototype;return t.onDown=function(){},t.onMove=function(){},t.onUp=function(){},t.createTouchInfo=function(e,t){var n={id:e._id,down:this.getTouchInfo(e,t),last:this.getTouchInfo(e,t),current:this.getTouchInfo(e,t)},i=this.touches.indexOf(null);return-1===i&&(i=this.touches.length,this.touches.push(null)),e.__id=i,this.touches[i]=n,n},t.refreshTouchInfo=function(e,t,n){e.last=e.current,e.current=this.getTouchInfo(t,n)},t.findTouch=function(e){return this.touches[e.__id]},t.destroyTouch=function(e){this.touches[e.__id]=null},t.getTouchInfo=function(e){var t=e.getLocation(),n=t.clone(),i=cc.Camera.main.getScreenToWorldPoint(e.getLocation());return n=this.node.convertToNodeSpaceAR(i),{time:this.manager.time,location:t,position:n,worldPosition:i}},e}();n.default=i,t.exports=n.default,cc._RF.pop()},{}],InputCatcher:[function(e,t){"use strict";cc._RF.push(t,"81046i4gF1AmYsU/Ln73WAB","InputCatcher");var n=a(e("GameEvent")),i=a(e("InputDirection")),o=a(e("InputType"));function a(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{direction:{default:i.default.None,type:i.default,tooltip:"\u043c\u0435\u0441\u0442\u043e \u043e\u0442\u043a\u0443\u0434\u0430 \u043f\u0440\u0438\u0448\u0435\u043b \u0438\u043d\u043f\u0443\u0442, \u043f\u043e \u044d\u043d\u0430\u043c\u0443 InputDirection"},target:{default:null,type:cc.Component,tooltip:"\u043a\u043e\u043c\u043f\u043e\u043d\u0435\u043d\u0442\u0430, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0431\u0443\u0434\u0435\u0442 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u0430 \u0432 \u043a\u043e\u043c\u0430\u043d\u0434\u0443. \u0412 \u043a\u043e\u043c\u0430\u043d\u0434\u0435 \u043c\u043e\u0436\u043d\u043e \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0435\u0435 \u043c\u0435\u0442\u043e\u0434\u044b"},analyticsArea:""},editor:{menu:"Input/InputCatcher"},onEnable:function(){this._handleSubscription(!0)},onDisable:function(){this._handleSubscription(!1)},_handleSubscription:function(e){var t=e?"on":"off";this.node[t](cc.Node.EventType.TOUCH_START,this.onDown,this),this.node[t](cc.Node.EventType.TOUCH_MOVE,this.onMove,this),this.node[t](cc.Node.EventType.TOUCH_END,this.onUp,this),this.node[t](cc.Node.EventType.TOUCH_CANCEL,this.onUp,this)},onDown:function(e){cc.systemEvent.emit(n.default.INPUT,o.default.Down,this.direction,e.touch,this,this.target)},onMove:function(e){cc.systemEvent.emit(n.default.INPUT,o.default.Move,this.direction,e.touch,this,this.target)},onUp:function(e){cc.systemEvent.emit(n.default.INPUT,o.default.Up,this.direction,e.touch,this,this.target)}}),cc._RF.pop()},{GameEvent:"GameEvent",InputDirection:"InputDirection",InputType:"InputType"}],InputDirection:[function(e,t,n){"use strict";cc._RF.push(t,"0e72cf2IpJFD5WUnkNsAV5v","InputDirection"),n.__esModule=!0,n.default=void 0;var i=cc.Enum({None:0,Puzzle:1});n.default=i,t.exports=n.default,cc._RF.pop()},{}],InputManager:[function(e,t){"use strict";cc._RF.push(t,"1d252+ECVNH8pgkI9is40hr","InputManager");var n=r(e("GameEvent")),i=r(e("InputDirection")),o=r(e("InputType")),a=r(e("PuzzleInputCommand"));function r(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{commands:{default:{},visible:!1,serializable:!1},_isFirstTap:{default:!0,serializable:!1},_isInput:{default:!1,serializable:!1}},editor:{menu:"Input/InputManager"},onLoad:function(){this._handleSubscription(!0),this.commands[i.default.Puzzle]=new a.default(this)},_handleSubscription:function(){cc.systemEvent.on(n.default.INPUT,this.onInput,this)},onInput:function(e,t,n,i,a){var r=this.commands[t];switch(e){case o.default.Down:r&&r.onDown(n,i,a),this._isInput=!0;break;case o.default.Move:r&&r.onMove(n,i,a);break;case o.default.Up:r&&(r.onUp(n,i,a),this._isInput=!1)}},onDown:function(){},onMove:function(){},onUp:function(){}}),cc._RF.pop()},{GameEvent:"GameEvent",InputDirection:"InputDirection",InputType:"InputType",PuzzleInputCommand:"PuzzleInputCommand"}],InputType:[function(e,t,n){"use strict";cc._RF.push(t,"a55f9VtZXtG9asuWKjwRLgJ","InputType"),n.__esModule=!0,n.default=void 0;var i=cc.Enum({None:0,Down:1,Move:2,Up:3,Cancel:4});n.default=i,t.exports=n.default,cc._RF.pop()},{}],NameController:[function(e,t){"use strict";cc._RF.push(t,"9fdb0fgxqdIN5PlrcUaPgCA","NameController");var n,i=(n=e("GameEvent"))&&n.__esModule?n:{default:n};cc.Class({extends:cc.Component,properties:{setEventName:{default:i.default.NONE,type:i.default},nameText:{default:null,type:cc.RichText}},onEnable:function(){this._handleSubscription(!0)},onDisable:function(){this._handleSubscription(!1)},_handleSubscription:function(e){var t=e?"on":"off";cc.systemEvent[t](this.setEventName,this.onSetName,this)},onSetName:function(e){this.nameText.string=e}}),cc._RF.pop()},{GameEvent:"GameEvent"}],NetworkManager:[function(e,t){"use strict";cc._RF.push(t,"bf393l5nyZFjrUXN9/mpTdj","NetworkManager"),cc.Class({extends:cc.Component,properties:{},start:function(){}}),cc._RF.pop()},{}],Player:[function(e,t){"use strict";var n;cc._RF.push(t,"09b2a92bQ5PTZ9g51bRJ/wI","Player"),(n=e("PuzzleStorage"))&&n.__esModule,cc.Class({extends:cc.Component,properties:{puzzleStorageComponent:{default:null,type:cc.Component},gridComponent:{default:null,type:cc.Component}},onEnable:function(){this._handleSubscription(!0)},onDisable:function(){this._handleSubscription(!1)},_handleSubscription:function(){}}),cc._RF.pop()},{PuzzleStorage:"PuzzleStorage"}],PuzzleInputCommand:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}cc._RF.push(t,"14122evetxIdbpZTWrqVKPX","PuzzleInputCommand"),n.__esModule=!0,n.default=void 0,i(e("GameEvent"));var a=function(e){var t,n;function i(t){return e.call(this,t)||this}n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,o(t,n);var a=i.prototype;return a.onDown=function(e,t,n){var i=e.getLocation(),o=cc.Camera.main.getScreenToWorldPoint(i);n.startMove(o)},a.onMove=function(e,t,n){var i=e.getLocation(),o=cc.Camera.main.getScreenToWorldPoint(i);n.move(o)},a.onUp=function(e,t,n){n.endMove()},i}(i(e("IInputCommand")).default);n.default=a,t.exports=n.default,cc._RF.pop()},{GameEvent:"GameEvent",IInputCommand:"IInputCommand"}],PuzzleStorage:[function(e,t){"use strict";cc._RF.push(t,"a5056hckVBLzpL6Gyo6pcIp","PuzzleStorage");var n=a(e("DataType")),i=a(e("GameEvent")),o=a(e("Puzzle"));function a(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{puzzlePrefab:{default:null,type:cc.Prefab},dataType:{default:n.default.None,type:n.default},_arrayGridData:[],_maxPuzzleInStorage:3,_arrayPuzzles:[]},onEnable:function(){this._getData(),this._generatePuzzles(),this._handleSubscription(!0)},onDisable:function(){this._handleSubscription(!1)},_handleSubscription:function(e){var t=e?"on":"off";cc.systemEvent[t](i.default.PUZZLE_PINNED,this.onPuzzlePinned,this)},_generatePuzzles:function(){for(var e=0;e<this._maxPuzzleInStorage;e++){var t=this._getRandomGridData(),n=this._createPuzzle(t),i=cc.v2(this.node.width/this._maxPuzzleInStorage*e+this.node.width/this._maxPuzzleInStorage/2,0);n.setScale(.5),n.setPosition(i),n.parent=this.node,this._arrayPuzzles.push(n)}},_getData:function(){var e=this;this.dataType!==n.default.None&&cc.systemEvent.emit(i.default.GET_DATA,this.dataType,function(t){e._arrayGridData=t.json.grids.slice(0)})},_createPuzzle:function(e){var t=cc.instantiate(this.puzzlePrefab);return t.getComponent(o.default).gridData=e,t},_getRandomGridData:function(){return this._arrayGridData[Math.floor(Math.random()*this._arrayGridData.length)]},onPuzzlePinned:function(e){var t=this._arrayPuzzles.findIndex(function(t){return t.node===e.node});this._arrayPuzzles.splice(t,1),this._arrayPuzzles.length||this._generatePuzzles()}}),cc._RF.pop()},{DataType:"DataType",GameEvent:"GameEvent",Puzzle:"Puzzle"}],Puzzle:[function(e,t){"use strict";cc._RF.push(t,"75688xwI4BFZpH6a6RZs5Pl","Puzzle");var n=o(e("GameEvent")),i=o(e("Cell"));function o(e){return e&&e.__esModule?e:{default:e}}cc.Class({extends:cc.Component,properties:{gridData:{default:[],visible:!1},inputCatcher:{default:null,type:cc.Node},blockPrefab:{default:null,type:cc.Prefab},cellPrefab:{default:null,type:cc.Prefab},dividerSize:5,offsetMove:cc.v2(),targetPosition:null,isPinned:!1,_oldParent:{default:null,serializable:!1},_oldScale:{default:null,serializable:!1},_oldPosition:{default:null,serializable:!1},_grid:{default:null,serializable:!1},_oldZIndex:0},onEnable:function(){this._init(),this._handleSubscription(!0)},onDisable:function(){this._handleSubscription(!1)},startMove:function(e){if(!this.isPinned){this._oldParent=this.node.parent,this._oldPosition=this.node.position.clone(),this._oldScale=this.node.scale,this._oldZIndex=this.node.zIndex,this.node.zIndex=1;var t=this.node.parent.convertToNodeSpaceAR(e),i=cc.v2(t.x,t.y+300);this.node.setPosition(i),cc.tween(this.node).to(.1,{scale:1}).start(),cc.systemEvent.emit(n.default.PUZZLE_CAPTURED,this)}},move:function(e){if(!this.isPinned){var t=this.node.parent.convertToNodeSpaceAR(e),i=cc.v2(t.x,t.y+300);this.node.setPosition(i),cc.systemEvent.emit(n.default.PUZZLE_MOVE,this)}},endMove:function(){if(!this.isPinned){if(this.targetPosition){var e=this.node.parent.convertToNodeSpaceAR(this.targetPosition);this.node.setPosition(e),this.inputCatcher.active=!1}else this._returnStorage();this.node.zIndex=0,cc.systemEvent.emit(n.default.PUZZLE_RELEASED,this)}},_init:function(){var e=this._getCorrectSize();this.node.setContentSize(e),this._grid=this._createGrid(),cc.systemEvent.emit(n.default.CREATE_TARGET_PUZZLE,this)},_getCorrectSize:function(){return cc.Size(this.gridData[0].length*this.blockPrefab.data.width+(this.gridData[0].length-1)*this.dividerSize,this.gridData.length*this.blockPrefab.data.height+(this.gridData.length-1)*this.dividerSize)},_createGrid:function(){for(var e=this.gridData.map(function(e){return e.slice(0)}),t=0;t<e.length;t++)for(var n=0;n<e[t].length;n++){var i=this._createCell(e[t][n]),o=i.getComponent("Cell"),a=cc.v2(-this.node.width/2+n*i.width+i.width/2+n*this.dividerSize,this.node.height/2-t*i.height-i.height/2-t*this.dividerSize);i.setPosition(a),i.parent=this.node,e[t][n]=o}return e},_createCell:function(e){var t=cc.instantiate(this.cellPrefab);return t.getComponent(i.default).isBusy=e,t},_returnStorage:function(){this.node.parent=this._oldParent,this.node.setPosition(this._oldPosition),cc.tween(this.node).to(.1,{scale:this._oldScale}).start()},_handleSubscription:function(){}}),cc._RF.pop()},{Cell:"Cell",GameEvent:"GameEvent"}],ScoreController:[function(e,t){"use strict";cc._RF.push(t,"5f0ddhtSqFDEYf6GpqU0P4s","ScoreController");var n,i=(n=e("GameEvent"))&&n.__esModule?n:{default:n};cc.Class({extends:cc.Component,properties:{updateScoreEvent:{default:i.default.NONE,type:i.default},scoreCounterText:{default:null,type:cc.RichText}},onEnable:function(){this._handleSubscription(!0)},onDisable:function(){this._handleSubscription(!1)},_handleSubscription:function(e){var t=e?"on":"off";cc.systemEvent[t](this.updateScoreEvent,this.onUpdateScore,this)},onUpdateScore:function(e){this.scoreCounterText.string=parseInt(this.scoreCounterText.string)+e+""}}),cc._RF.pop()},{GameEvent:"GameEvent"}],TargetPuzzleHelper:[function(e,t){"use strict";cc._RF.push(t,"24c50hzDzhF5ZJV47SthFF7","TargetPuzzleHelper"),cc.Class({name:"TargetPuzzleHelper",properties:{puzzle:null,availablePositions:[],oldAvailablePositionIndex:-1,currentAvailablePositionIndex:null}}),cc._RF.pop()},{}],TimerController:[function(e,t){"use strict";cc._RF.push(t,"483a7ZwO9RFoI9i7HIvqFlf","TimerController");var n,i=(n=e("GameEvent"))&&n.__esModule?n:{default:n};cc.Class({extends:cc.Component,properties:{updateTimerEvent:{default:i.default.NONE,type:i.default},timerText:{default:null,type:cc.RichText}},onEnable:function(){this._handleSubscription(!0)},onDisable:function(){this._handleSubscription(!1)},_handleSubscription:function(e){var t=e?"on":"off";cc.systemEvent[t](this.updateTimerEvent,this.onUpdateTimer,this)},onUpdateTimer:function(e){this.timerText.string=e}}),cc._RF.pop()},{GameEvent:"GameEvent"}]},{},["DataDictionary","DataType","GameEvent","GameObject","GameObjectManager","GameObjectType","GameManager","IInputCommand","PuzzleInputCommand","InputDirection","InputType","InputCatcher","InputManager","NetworkManager","Cell","CellGameField","CellGridPlayer","CellPuzzle","Enemy","GameField","GridPlayer","AvailablePositionsHelper","TargetPuzzleHelper","NameController","Player","PuzzleStorage","Puzzle","ScoreController","TimerController"]);